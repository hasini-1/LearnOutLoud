"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createCanvas = createCanvas;
exports.createCanvasFromMedia = createCanvasFromMedia;
const env_1 = require("../env");
const getContext2dOrThrow_1 = require("./getContext2dOrThrow");
const getMediaDimensions_1 = require("./getMediaDimensions");
const isMediaLoaded_1 = require("./isMediaLoaded");
function createCanvas({ width, height }) {
    const { createCanvasElement } = env_1.env.getEnv();
    const canvas = createCanvasElement();
    canvas.width = width;
    canvas.height = height;
    return canvas;
}
function createCanvasFromMedia(media, dims) {
    const { ImageData } = env_1.env.getEnv();
    if (!(media instanceof ImageData) && !(0, isMediaLoaded_1.isMediaLoaded)(media)) {
        throw new Error('createCanvasFromMedia - media has not finished loading yet');
    }
    const { width, height } = dims || (0, getMediaDimensions_1.getMediaDimensions)(media);
    const canvas = createCanvas({ width, height });
    if (media instanceof ImageData) {
        (0, getContext2dOrThrow_1.getContext2dOrThrow)(canvas).putImageData(media, 0, 0);
    }
    else {
        (0, getContext2dOrThrow_1.getContext2dOrThrow)(canvas).drawImage(media, 0, 0, width, height);
    }
    return canvas;
}
