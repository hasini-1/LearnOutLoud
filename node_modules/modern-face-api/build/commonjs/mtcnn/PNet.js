"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PNet = PNet;
const tf = require("@tensorflow/tfjs-core");
const common_1 = require("../common");
const sharedLayers_1 = require("./sharedLayers");
function PNet(x, params) {
    return tf.tidy(() => {
        const out = (0, sharedLayers_1.sharedLayer)(x, params, true);
        const conv = (0, common_1.convLayer)(out, params.conv4_1, 'valid');
        const max = tf.expandDims(tf.max(conv, 3), 3);
        const prob = tf.softmax(tf.sub(conv, max), 3);
        const regions = (0, common_1.convLayer)(out, params.conv4_2, 'valid');
        return { prob, regions };
    });
}
